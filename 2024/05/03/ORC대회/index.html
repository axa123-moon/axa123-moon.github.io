<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"axa123-moon.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="문자 인식 대회1.Abstract1.1 Goal of the Competition 인공지능 모델을 이용하여 제공된 영수증 이미지에서 문자의 위치를 정확하게 검출  1.2 Timeline 2024.04.08 ~ 2024.05.02 19:00  1.3 Description of the work 제공되는 3273장의 train 이미지와 404개의 validati">
<meta property="og:type" content="article">
<meta property="og:title" content="ORC대회">
<meta property="og:url" content="https://axa123-moon.github.io/2024/05/03/ORC%EB%8C%80%ED%9A%8C/index.html">
<meta property="og:site_name" content="AI Beginner&#39;s Blog">
<meta property="og:description" content="문자 인식 대회1.Abstract1.1 Goal of the Competition 인공지능 모델을 이용하여 제공된 영수증 이미지에서 문자의 위치를 정확하게 검출  1.2 Timeline 2024.04.08 ~ 2024.05.02 19:00  1.3 Description of the work 제공되는 3273장의 train 이미지와 404개의 validati">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/05.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/06.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/07.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/01.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/08.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/02.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/03.PNG">
<meta property="og:image" content="https://axa123-moon.github.io/images/OCRPrediction/04.PNG">
<meta property="article:published_time" content="2024-05-03T01:25:04.000Z">
<meta property="article:modified_time" content="2024-05-03T02:41:31.175Z">
<meta property="article:author" content="axa123">
<meta property="article:tag" content="패스트캠퍼스">
<meta property="article:tag" content="UpstageAILab">
<meta property="article:tag" content="Upstage">
<meta property="article:tag" content="부트캠프">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="데이터사이언스">
<meta property="article:tag" content="OCR 대회">
<meta property="article:tag" content="Receipt Text Detection">
<meta property="article:tag" content="데이터분석">
<meta property="article:tag" content="인공지능개발자">
<meta property="article:tag" content="딥러닝">
<meta property="article:tag" content="경진대회">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://axa123-moon.github.io/images/OCRPrediction/05.PNG">


<link rel="canonical" href="https://axa123-moon.github.io/2024/05/03/ORC%EB%8C%80%ED%9A%8C/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://axa123-moon.github.io/2024/05/03/ORC%EB%8C%80%ED%9A%8C/","path":"2024/05/03/ORC대회/","title":"ORC대회"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ORC대회 | AI Beginner's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">AI Beginner's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%EB%AC%B8%EC%9E%90-%EC%9D%B8%EC%8B%9D-%EB%8C%80%ED%9A%8C"><span class="nav-number">1.</span> <span class="nav-text">문자 인식 대회</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Abstract"><span class="nav-number">1.1.</span> <span class="nav-text">1.Abstract</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Goal-of-the-Competition"><span class="nav-number">1.2.</span> <span class="nav-text">1.1 Goal of the Competition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Timeline"><span class="nav-number">1.3.</span> <span class="nav-text">1.2 Timeline</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-Description-of-the-work"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 Description of the work</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Process-Competition-Model"><span class="nav-number">1.5.</span> <span class="nav-text">2. Process : Competition Model</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#resnet18-a2-in1k"><span class="nav-number">1.5.0.1.</span> <span class="nav-text">resnet18.a2_in1k</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#convnext-tiny-fb-in1k"><span class="nav-number">1.5.0.2.</span> <span class="nav-text">convnext_tiny.fb_in1k</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#efficientnet-b5-sw-in12k-ft-in1k"><span class="nav-number">1.5.0.3.</span> <span class="nav-text">efficientnet_b5.sw_in12k_ft_in1k</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tf-efficientnetv2-m-in21k-ft-in1k"><span class="nav-number">1.5.0.4.</span> <span class="nav-text">tf_efficientnetv2_m.in21k_ft_in1k</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Process-Issues"><span class="nav-number">1.6.</span> <span class="nav-text">3. Process : Issues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Describe-the-issue-that-your-team-faced-during-the-project"><span class="nav-number">1.7.</span> <span class="nav-text">3.1 Describe the issue that your team faced during the project.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Describe-the-possible-solution-to-imporve-your-project"><span class="nav-number">1.8.</span> <span class="nav-text">3.2 Describe the possible solution to imporve your project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-1-Backbone-%EB%AA%A8%EB%8D%B8-%EB%B3%80%EA%B2%BD"><span class="nav-number">1.9.</span> <span class="nav-text">3.2.1 Backbone 모델 변경</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A0%84%EC%B2%98%EB%A6%AC"><span class="nav-number">1.10.</span> <span class="nav-text">3.2.2 이미지 전처리</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-3-Train%EB%8D%B0%EC%9D%B4%ED%84%B0-Word-box-%EB%B3%B4%EC%A0%95"><span class="nav-number">1.11.</span> <span class="nav-text">3.2.3 Train데이터 Word box 보정</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-4-Hyperparameter-%EC%A1%B0%EC%A0%95"><span class="nav-number">1.12.</span> <span class="nav-text">3.2.4 Hyperparameter 조정</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Role"><span class="nav-number">1.13.</span> <span class="nav-text">4. Role</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Result"><span class="nav-number">1.14.</span> <span class="nav-text">5. Result</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%ED%95%99%EC%8A%B5-%EA%B2%B0%EA%B3%BC"><span class="nav-number">1.14.1.</span> <span class="nav-text">5.1 학습 결과</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%EB%A6%AC%EB%8D%94%EB%B3%B4%EB%93%9C-%EA%B2%B0%EA%B3%BC"><span class="nav-number">1.14.2.</span> <span class="nav-text">5.2 리더보드 결과</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Conclusion"><span class="nav-number">1.15.</span> <span class="nav-text">6. Conclusion</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">axa123</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://axa123-moon.github.io/2024/05/03/ORC%EB%8C%80%ED%9A%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="axa123">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AI Beginner's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ORC대회 | AI Beginner's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ORC대회
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-05-03 10:25:04 / Modified: 11:41:31" itemprop="dateCreated datePublished" datetime="2024-05-03T10:25:04+09:00">2024-05-03</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="문자-인식-대회"><a href="#문자-인식-대회" class="headerlink" title="문자 인식 대회"></a>문자 인식 대회</h1><h2 id="1-Abstract"><a href="#1-Abstract" class="headerlink" title="1.Abstract"></a>1.Abstract</h2><h2 id="1-1-Goal-of-the-Competition"><a href="#1-1-Goal-of-the-Competition" class="headerlink" title="1.1 Goal of the Competition"></a>1.1 Goal of the Competition</h2><ul>
<li>인공지능 모델을 이용하여 제공된 영수증 이미지에서 문자의 위치를 정확하게 검출</li>
</ul>
<h2 id="1-2-Timeline"><a href="#1-2-Timeline" class="headerlink" title="1.2 Timeline"></a>1.2 Timeline</h2><ul>
<li>2024.04.08 ~ 2024.05.02 19:00</li>
</ul>
<h2 id="1-3-Description-of-the-work"><a href="#1-3-Description-of-the-work" class="headerlink" title="1.3 Description of the work"></a>1.3 Description of the work</h2><ul>
<li><p>제공되는 3273장의 train 이미지와 404개의 validation 이미지를 통해 413장의 test 이미지에서 문자의 위치를 예측</p>
</li>
<li><p>평가 이미지의 경우 실제 현실 세계의 노이즈가 존재함 (구겨짐, 글자번짐, 스탬프, 글자비침, 워터마크, 손글씨 등등)</p>
</li>
<li><p>각 이미지의 word box 정보 포함한 json 파일을 참조</p>
</li>
<li><p>원본이미지<br><img src="/images/OCRPrediction/05.PNG" alt="원본이미지"></p>
</li>
<li><p>원본이미지 (word box 적용)<br><img src="/images/OCRPrediction/06.PNG" alt="word box 적용 이미지"></p>
</li>
<li><p>json 구조<br><img src="/images/OCRPrediction/07.PNG" alt="json 구조"></p>
</li>
</ul>
<h2 id="2-Process-Competition-Model"><a href="#2-Process-Competition-Model" class="headerlink" title="2. Process : Competition Model"></a>2. Process : Competition Model</h2><ul>
<li>DBNET을 기반으로하여 다양한 encoder모델을 적용하였음. 또한 DBNET++ 구조도 적용함.</li>
</ul>
<p><img src="/images/OCRPrediction/01.PNG"></p>
<h4 id="resnet18-a2-in1k"><a href="#resnet18-a2-in1k" class="headerlink" title="resnet18.a2_in1k"></a>resnet18.a2_in1k</h4><ul>
<li>Model Type: Image classification &#x2F; feature backbone</li>
<li>Model Stats:</li>
<li>Params (M): 11.7</li>
<li>GMACs: 1.8</li>
<li>Activations (M): 2.5</li>
<li>Image size: 224 x 224</li>
</ul>
<h4 id="convnext-tiny-fb-in1k"><a href="#convnext-tiny-fb-in1k" class="headerlink" title="convnext_tiny.fb_in1k"></a>convnext_tiny.fb_in1k</h4><ul>
<li>Model Type: Image classification &#x2F; feature backbone</li>
<li>Model Stats:</li>
<li>Params (M): 28.6</li>
<li>GMACs: 4.5</li>
<li>Activations (M): 13.4</li>
<li>Image size: 224 x 224</li>
</ul>
<h4 id="efficientnet-b5-sw-in12k-ft-in1k"><a href="#efficientnet-b5-sw-in12k-ft-in1k" class="headerlink" title="efficientnet_b5.sw_in12k_ft_in1k"></a>efficientnet_b5.sw_in12k_ft_in1k</h4><ul>
<li>Model Type: Image classification &#x2F; feature backbone</li>
<li>Model Stats:</li>
<li>Params (M): 30.4</li>
<li>GMACs: 9.6</li>
<li>Activations (M): 93.6</li>
<li>Image size: 448 x 448</li>
</ul>
<h4 id="tf-efficientnetv2-m-in21k-ft-in1k"><a href="#tf-efficientnetv2-m-in21k-ft-in1k" class="headerlink" title="tf_efficientnetv2_m.in21k_ft_in1k"></a>tf_efficientnetv2_m.in21k_ft_in1k</h4><ul>
<li>Model Type: Image classification &#x2F; feature backbone</li>
<li>Model Stats:</li>
<li>Params (M): 54.1</li>
<li>GMACs: 15.9</li>
<li>Activations (M): 57.5</li>
<li>Image size: 384 x 384</li>
</ul>
<h2 id="3-Process-Issues"><a href="#3-Process-Issues" class="headerlink" title="3. Process : Issues"></a>3. Process : Issues</h2><h2 id="3-1-Describe-the-issue-that-your-team-faced-during-the-project"><a href="#3-1-Describe-the-issue-that-your-team-faced-during-the-project" class="headerlink" title="3.1 Describe the issue that your team faced during the project."></a>3.1 Describe the issue that your team faced during the project.</h2><ul>
<li>Base code가 pytorch lightenin과 hydra로 구성되어 있어서 분석하는데 시간이 필요하였음</li>
<li>hyperparameter로 성능 향상 후에 다양한 encoder모델을 적용하였으나, 성능 향상이 되지 않았음</li>
</ul>
<h2 id="3-2-Describe-the-possible-solution-to-imporve-your-project"><a href="#3-2-Describe-the-possible-solution-to-imporve-your-project" class="headerlink" title="3.2 Describe the possible solution to imporve your project"></a>3.2 Describe the possible solution to imporve your project</h2><h2 id="3-2-1-Backbone-모델-변경"><a href="#3-2-1-Backbone-모델-변경" class="headerlink" title="3.2.1 Backbone 모델 변경"></a>3.2.1 Backbone 모델 변경</h2><ul>
<li>DBNET 구조를 DBNET++ 구조로 변경하여 성능 향상 있었음 (<a target="_blank" rel="noopener" href="https://paperswithcode.com/paper/real-time-scene-text-detection-with-1">Adaptive Scale Fusion Module</a> 적용)</li>
</ul>
<h2 id="3-2-2-이미지-전처리"><a href="#3-2-2-이미지-전처리" class="headerlink" title="3.2.2 이미지 전처리"></a>3.2.2 이미지 전처리</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.google.co.kr/">Rembg</a> : 이미지에서 배경을 제거하는 라이브러리 적용 (성능향상 없음)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> rembg <span class="keyword">import</span> remove</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_images_with_rembg</span>(<span class="params">image_dir, json_path, output_image_dir</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    - image_dir: 원본 이미지가 저장된 디렉토리 경로</span></span><br><span class="line"><span class="string">    - json_path: 이미지 메타데이터가 저장된 JSON 파일 경로</span></span><br><span class="line"><span class="string">    - output_image_dir: 배경이 제거된 이미지를 저장할 디렉토리 경로</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 출력 디렉토리가 존재하지 않는 경우 생성</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_image_dir):</span><br><span class="line">        os.makedirs(output_image_dir)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># JSON 파일 로드</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(json_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = json.load(f)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 이미지 및 JSON 보정</span></span><br><span class="line">    <span class="keyword">for</span> image_file, image_data <span class="keyword">in</span> data[<span class="string">&quot;images&quot;</span>].items():</span><br><span class="line">        <span class="comment"># 이미지 파일 경로 생성</span></span><br><span class="line">        image_path = os.path.join(image_dir, image_file)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 이미지 로드 및 배경 제거</span></span><br><span class="line">        image = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">        output = remove(image)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 배경 제거된 이미지 저장</span></span><br><span class="line">        output_image_path = os.path.join(output_image_dir, image_file)</span><br><span class="line">        output_rgb = output.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">        output_rgb.save(output_image_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 함수 사용 예시</span></span><br><span class="line">image_dir = <span class="string">&#x27;/data/ephemeral/home/datasets/images/train/&#x27;</span></span><br><span class="line">json_path = <span class="string">&#x27;/data/ephemeral/home/datasets/jsons/train.json&#x27;</span></span><br><span class="line">output_image_dir = <span class="string">&#x27;/data/ephemeral/home/datasets/images/Rembg_train/&#x27;</span></span><br><span class="line">process_images_with_rembg(image_dir, json_path, output_image_dir)</span><br></pre></td></tr></table></figure>


<ul>
<li>이미지 crop : 배경 제거를 위해 gt의 최소점 x_min, y_min 과 최대점 x_max, y_max를 통해 crop_image의 w, h을 구한 뒤 10% 비율을 적용하여 image를 crop (성능향상 있음)</li>
</ul>
<h2 id="3-2-3-Train데이터-Word-box-보정"><a href="#3-2-3-Train데이터-Word-box-보정" class="headerlink" title="3.2.3 Train데이터 Word box 보정"></a>3.2.3 Train데이터 Word box 보정</h2><ul>
<li>아래 조건의 경우 word box를 제외함 (성능향상 없음)<br>(워터마크, 모자이크 된 곳에 word box가 있는 것, 빈 박스, 글자가 아닌 것(그림), 영수증 밖에 있는 word box, 손가락에 가려진 word box)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"></span><br><span class="line">anns = &#123;&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/data/datasets/jsons/train.json&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pred = json.load(f)</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> pred[<span class="string">&#x27;images&#x27;</span>].keys():</span><br><span class="line">        <span class="comment"># Image file이 경로에 존재하는지 확인</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;words&#x27;</span> <span class="keyword">in</span> pred[<span class="string">&#x27;images&#x27;</span>][filename]:</span><br><span class="line">            <span class="comment"># Words의 Points 변환</span></span><br><span class="line">            gt_words = pred[<span class="string">&#x27;images&#x27;</span>][filename][<span class="string">&#x27;words&#x27;</span>]</span><br><span class="line">            polygons = [np.array([np.<span class="built_in">round</span>(word_data[<span class="string">&#x27;points&#x27;</span>])], dtype=np.int32)</span><br><span class="line">                        <span class="keyword">for</span> word_data <span class="keyword">in</span> gt_words.values()</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">len</span>(word_data[<span class="string">&#x27;points&#x27;</span>])]</span><br><span class="line">            anns[filename] = polygons</span><br><span class="line"></span><br><span class="line">idx = <span class="number">1009</span> <span class="comment"># 영수증이미지 index</span></span><br><span class="line"></span><br><span class="line">index = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">10</span>,<span class="number">20</span>)) <span class="comment"># word box 10~19</span></span><br><span class="line">index = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">10</span>)) <span class="comment"># word box 0~9</span></span><br><span class="line"><span class="comment">#index = []</span></span><br><span class="line"></span><br><span class="line">index2 = [<span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>] <span class="comment"># 제외할 word box index</span></span><br><span class="line"></span><br><span class="line">index = index + index2</span><br><span class="line">root_path = <span class="string">&#x27;/data/ephemeral/home/datasets/images/train/&#x27;</span></span><br><span class="line">image_name = <span class="built_in">list</span>(anns.keys())[idx]</span><br><span class="line"><span class="comment"># image_name = &#x27;drp.en_ko.in_house.selectstar_000042.jpg&#x27;</span></span><br><span class="line">image_path = os.path.join(root_path, image_name)</span><br><span class="line">image_org = cv2.imread(image_path)</span><br><span class="line">image = image_org.copy()</span><br><span class="line">polygons = anns[image_name]</span><br><span class="line"><span class="built_in">print</span>(image_name)</span><br><span class="line"><span class="built_in">print</span>(idx)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line"><span class="keyword">for</span> i, box <span class="keyword">in</span> <span class="built_in">enumerate</span>(polygons[::-<span class="number">1</span>]):</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> index:</span><br><span class="line">        <span class="comment">#print(box)</span></span><br><span class="line">        box = np.array(box).reshape(-<span class="number">1</span>, <span class="number">2</span>).astype(np.int32)</span><br><span class="line">        <span class="comment">#print(len(box))</span></span><br><span class="line">        x = box[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        y = box[<span class="number">0</span>][<span class="number">1</span>] - <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> y &lt; <span class="number">0</span>:</span><br><span class="line">            y = <span class="number">0</span></span><br><span class="line">        org = (x, y)</span><br><span class="line">        <span class="comment">#org = (50,50)</span></span><br><span class="line">        <span class="comment">#print(org)</span></span><br><span class="line">        fontFace = cv2.FONT_HERSHEY_SIMPLEX</span><br><span class="line">        fontScale = <span class="number">1</span></span><br><span class="line">        color = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        thickness = <span class="number">2</span></span><br><span class="line">        lineType = cv2.LINE_AA</span><br><span class="line">        text = <span class="built_in">str</span>(i)</span><br><span class="line">        cv2.putText(image, text, org, fontFace, fontScale, color, thickness, lineType)</span><br><span class="line">        cv2.polylines(image, [box], <span class="literal">True</span>, (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), thickness=<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        box = np.array(box).reshape(-<span class="number">1</span>, <span class="number">2</span>).astype(np.int32)</span><br><span class="line">        cv2.polylines(image, [box], <span class="literal">True</span>, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), thickness=<span class="number">2</span>)</span><br><span class="line">output = np.hstack((image_org, image))</span><br><span class="line">plt.imshow(output)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/images/OCRPrediction/08.PNG"></p>
<h2 id="3-2-4-Hyperparameter-조정"><a href="#3-2-4-Hyperparameter-조정" class="headerlink" title="3.2.4 Hyperparameter 조정"></a>3.2.4 Hyperparameter 조정</h2><ul>
<li>use_polygon: True (성능 향상에 가장 큰 요소)</li>
<li>box_thresh: 0.47 (성능향상 있음)</li>
<li>thresh_map_loss_weight: 12.0 (성능향상 있음)</li>
<li>max_candidates: 500 (성능향상 있음)</li>
<li>negative_ratio: 3.5 (성능향상 있음)</li>
</ul>
<h2 id="4-Role"><a href="#4-Role" class="headerlink" title="4. Role"></a>4. Role</h2><ul>
<li>각자 본인들의 의견에 따라 모델 선정을 진행하고, 하이퍼파라메터를 조정하여 학습하였음</li>
<li>Train데이터 Word box 보정의 경우 시간이 많이 소요되어 배분하여 작업 진행</li>
</ul>
<h2 id="5-Result"><a href="#5-Result" class="headerlink" title="5. Result"></a>5. Result</h2><h3 id="5-1-학습-결과"><a href="#5-1-학습-결과" class="headerlink" title="5.1 학습 결과"></a>5.1 학습 결과</h3><p><img src="/images/OCRPrediction/02.PNG"></p>
<h3 id="5-2-리더보드-결과"><a href="#5-2-리더보드-결과" class="headerlink" title="5.2 리더보드 결과"></a>5.2 리더보드 결과</h3><ul>
<li><p>리더보드 (대회진행)<br><img src="/images/OCRPrediction/03.PNG"></p>
</li>
<li><p>리더보드 (최종)<br><img src="/images/OCRPrediction/04.PNG"></p>
</li>
</ul>
<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6. Conclusion"></a>6. Conclusion</h2><ul>
<li>팀으로 진행하면서 각자 생각한 의견 및 분석 결과를 공유함으로 데이터를 이해하고, 모델 학습을 진행하는데 도움이 많이 되었음.</li>
<li>다양한 Hyperparmeter를 조정함으로 성능을 향상시키는 방법을 확인 하였음</li>
<li>이미지 데이터를 전처리 함으로 성능을 향상시키는 방법을 확인 하였음</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%ED%8C%A8%EC%8A%A4%ED%8A%B8%EC%BA%A0%ED%8D%BC%EC%8A%A4/" rel="tag"># 패스트캠퍼스</a>
              <a href="/tags/UpstageAILab/" rel="tag"># UpstageAILab</a>
              <a href="/tags/Upstage/" rel="tag"># Upstage</a>
              <a href="/tags/%EB%B6%80%ED%8A%B8%EC%BA%A0%ED%94%84/" rel="tag"># 부트캠프</a>
              <a href="/tags/AI/" rel="tag"># AI</a>
              <a href="/tags/%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%82%AC%EC%9D%B4%EC%96%B8%EC%8A%A4/" rel="tag"># 데이터사이언스</a>
              <a href="/tags/OCR-%EB%8C%80%ED%9A%8C/" rel="tag"># OCR 대회</a>
              <a href="/tags/Receipt-Text-Detection/" rel="tag"># Receipt Text Detection</a>
              <a href="/tags/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B6%84%EC%84%9D/" rel="tag"># 데이터분석</a>
              <a href="/tags/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5%EA%B0%9C%EB%B0%9C%EC%9E%90/" rel="tag"># 인공지능개발자</a>
              <a href="/tags/%EB%94%A5%EB%9F%AC%EB%8B%9D/" rel="tag"># 딥러닝</a>
              <a href="/tags/%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C/" rel="tag"># 경진대회</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/04/03/OpenAI-function-calling/" rel="prev" title="OpenAI function calling">
                  <i class="fa fa-angle-left"></i> OpenAI function calling
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">axa123</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
